{%- extends "_main.jinja" -%}
{%- block main -%}

<h2>Úprava stanoviště</h2>
<form action="{{url_for('admin' ~ year.year ~ ".edit_place", place_id=place.id)}}" method="post">
  {{ form.csrf_token }}
  <div class="form-row">
    <div class="col"><label for="name">{{ form.name.label }}</label></div>
    <div class="col">{{ form.name(class="form-control", id="name", placeholder="Název") }}</div>
  </div>
  <div class="form-row">
    <div class="col"><label for="latitude">{{ form.latitude.label }}</label></div>
    <div class="col">{{ form.latitude(class="form-control", id="latitude", placeholder="Zem. šířka") }}</div>
  </div>
  <div class="form-row">  
    <div class="col"><label for="longitude">{{ form.longitude.label }}</label></div>
    <div class="col">{{ form.longitude(class="form-control", id="longitude", placeholder="Zem. délka") }}</div>
  </div>
  
  
  
  <div id="map2" style="height: 500px;"></div>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
  <script src="https://unpkg.com/leaflet@latest/dist/leaflet.js"></script>
  <script>
      const map = L.map('map2').setView([{{place.latitude}}, {{place.longitude}}], 15);
      const marker = L.marker([{{place.latitude}}, {{place.longitude}}]).addTo(map);
      const tiles = L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
          maxZoom: 19,
          attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
      }).addTo(map);
      map.on('click', function(ev) {
        console.log(ev.latlng, ev.latlng.lat);
        const elat = document.getElementById("latitude");
        const elon = document.getElementById("longitude");
        elat.value = ev.latlng.lat;
        elon.value = ev.latlng.lng;
        marker.setLatLng(ev.latlng)
      });
  </script>
  
  <button type="submit" class="btn btn-primary">Upravit stanoviště</button>
  <button type="button"  class="btn btn-primary" onclick="history.back()">Zpět</button>
</form>
{%- endblock -%}
